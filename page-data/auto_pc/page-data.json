{
    "componentChunkName": "component---src-templates-post-js",
    "path": "/auto_pc/",
    "result": {"data":{"markdownRemark":{"html":"<p>In this guide you're going to learn how to turn on and control your PC from your Android smartphone (no root required).\r\nI will go over the process step by step.</p>\n<p>Before we get started though, I have to warn you that the responsibility for any damages caused by following this guide is only\r\nyours. Please keep in mind that this will introduce a second way to access the computer in question.</p>\n<h1>What will you need</h1>\r\nThis list is rather short and straight forward, you will only need:\n<ul>\n<li>An Android device</li>\n<li>A computer with Windows 10 and a Wake-on-LAN capability</li>\n</ul>\n<p>That's it, well basically...</p>\n<h1>Step 1: Installing the apps</h1>\n<p>The only two apps you'll need are going to be Automate and ConnectBot and they're both free!</p>\n<p>You can find the play store link for Automate <a href=\"https://play.google.com/store/apps/details?id=com.llamalab.automate&#x26;hl=en\" target=\"_blank\">here</a>.<br>\r\nAnd the link for ConnectBot <a href=\"https://play.google.com/store/apps/details?id=org.connectbot&#x26;hl=en\" target=\"_blank\">here</a>.</p>\n<h1>Step 2: Configuring Wake-on-LAN</h1>\r\nIf your computer allows it, you can boot it up by sending it a special Wake-on-LAN packet. The packet contains your computer's\r\nMAC address, which will be important later.\n<p>To enable this, you will need to go into your computer's BIOS settings and maybe even configure your network adapter in the device manager.\r\nI got all that information from a single <a href=\"https://www.howtogeek.com/70374/how-to-geek-explains-what-is-wake-on-lan-and-how-do-i-enable-it/\" target=\"_blank\">source</a>,\r\nthere they go into more depth about WoL and how to enable it on different operating systems.</p>\n<h3>To summarize for Windows:</h3>\n<p>First you'll need to enable WoL in your BIOS which can be tricky since your BIOS UI probably differs from mine.\r\nRestart your computer and in the loading screen press either: <b>DEL</b>, <b>F1</b>, <b>F9</b>, <b>F10</b>, <b>F12</b> or whatever your specific motherboard uses.\r\nNow the tricky part. Somewhere in the BIOS menu there will be an option to turn on Wake-on-LAN. Where? I can't say for you but for me\r\nit was under Settings\\Advanced\\Wake Up Event Setup\\Resume By PCI-E Device -> Enabled</p>\n<p>With BIOS configured it's time to check the Network Adapter in Windows\r\nGo into your Device Manager: press \"<i>windows key</i>\"+\"<i>x</i>\" and then press \"<i>m</i>\", there you will see a section called \"Network adapters\".\r\nRight click your network adapter (for me it was the one with \"PCIe\" in name) and click on properties.\r\nGo to \"Advanced\" and scroll down until you find \"Wake on Magic Packet\", make sure it's \"Enabled\".\r\nNow go to \"Power Management\" and tick the \"Allow this device to wake the computer\" together with \"Only allow a magic packet to wake the computer\".\r\nClick OK and you should be done.</p>\n<p>To troubleshoot your WoL, because who are we kidding, nothing ever goes smoothly, you can use this tool from depicus:<br>\r\n<a href=\"https://www.depicus.com/wake-on-lan/wake-on-lan-monitor\" target=\"_blank\">https://www.depicus.com/wake-on-lan/wake-on-lan-monitor</a> <br>\r\nIt will let you see if the magic packet is actually being received. If it's not then there might be a problem with your\r\nrouter not propagating the WoL packet through your local network.</p>\n<h3>Get your MAC address</h3>\n<p>Lastly you will need your PC's MAC address. Open command prompt and type in:</p>\n<div class=\"gatsby-highlight\" data-language=\"cmd\"><pre class=\"language-cmd\"><code class=\"language-cmd\">ipconfig /all</code></pre></div>\n<p>You will get something similar to this:</p>\n<div class=\"gatsby-highlight\" data-language=\"cmd\"><pre class=\"language-cmd\"><code class=\"language-cmd\">Windows IP Configuration\r\n\r\n   Host Name . . . . . . . . . . . . : DESKTOP-XXXXXX\r\n   Primary Dns Suffix  . . . . . . . :\r\n   Node Type . . . . . . . . . . . . : Hybrid\r\n   IP Routing Enabled. . . . . . . . : No\r\n   WINS Proxy Enabled. . . . . . . . : No\r\n   DNS Suffix Search List. . . . . . : home\r\n\r\nEthernet adapter Ethernet:\r\n\r\n   Connection-specific DNS Suffix  . : home\r\n   Description . . . . . . . . . . . : Description of your controller\r\n   Physical Address. . . . . . . . . : 00-11-22-AA-BB-CC\r\n   DHCP Enabled. . . . . . . . . . . : Yes\r\n   Autoconfiguration Enabled . . . . : Yes\r\n   IPv6 Address. . . . . . . . . . . : your IPv6 address\r\n    .\r\n    .\r\n    .</code></pre></div>\n<p>Your MAC address is the \"Physical Address\". You will need it in the next step.</p>\n<h1>Step 3: Automate Wake-on-LAN</h1>\r\nConveniently Automate can send a Wake-on-LAN magic packet.<br>\r\nOpen the app and create the following flow.\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e75d54d863f8e3009a5427c99d5039a8/eefce/WoLFlow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 211.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAqCAIAAAA8m+yHAAAACXBIWXMAAAsTAAALEwEAmpwYAAADr0lEQVRIx61UzW8bRRSfOE2/UKRGQpUo0HIBVRRO/BUceuPEhQMnBG2pqbNJQwj0w6paWqECEhxAooEKJESKlUqJ47Wd2MkmrkGtEzeO7VLbdNf2ej1eZ2Y/vJ9od6kxhiQbwk9Po9/bmbfvpzdvHugdIp+/vPDytcXdw2EPQXZaL0H2EGTfcPiIf/7oFeroFeqFywvHrlJPX4gfPDfXS5DAQ5ADH84ePDfnGSTBezPgTAj4QhbxWaRnkNw1RB74YHZgbLZ/NDowNvvU+Vj/aHTfSMRDkGDv2Uj/aBT4Qk9+NHfs6uJhf/zQhdhL1xafuRg77I/vH4n02Yr2jUSeeD/ikL7h8P6RyN6zEeA5Nb2bIMHbU3sGQ89dsvQ/64+/cj1x6GLsxY+pPaeD4J0pcGIKnA5admIKeGfAyWmPN9hzahoQt7O+yeywta69+3PmTGDNG8icvLXqDWS8gQxxOztkG2HbUHudtFZg7gBA1Q3NNrVjdekCwzCc3zhkW+7OZO8ouEuJaZq6rqs2NE3r5K5kI4Sq1SrHcQzDFIvFWq3Gsmy9Xm9HbpYZY8yyLEKIoqiJiQmO4yCEXcEbZsYYZzKZbDabSqWSyWQul1tdXa1UKq4KhhAqlUq5XC6ZvJNILN1Pp0ulUrlcdlUwURTrsKEK/Jex8uvjpTqE600LrmRbBbf3YoXWpxR+fNjYOvNfh2ym/4cOc440JP1BXWm7rgqmKArComlIny80j3/bwIIoS5Isy1vIdniz2WTK5fVGPfJr/pMf5/lGo1KpcBznqmCCIFSr1XWE7ixRP/1wk+d5Vx3mcFEU8/n8ysrK8nJqZfleZm0tnU7XarW/FWWTDqNpukw/yhWZu3maYWiaprtkb1iwVqvFN5Gpiddj8NWvq+sICxhjLLjqsPbdPGpqid9b/1S7xT1rurUXL7Q+o7BpGKbhosMcbr1nllNw46v56hs3GQgbENZ5nnd1VQghhmEQQtFIePzGN5w9DNwWDGPsTJKlRCIYnHFK7faenUnClMvF33KV0oNCocDZcNthlSorNuuTKc4/w0IIuVoNQuhqhum63lJU09S/v4ffugVVVdU1ze307NBmavr/OvSd3Mbmk+RfXQdQUGRV315mZySN/8IcGIu+diMlq/o2Mjv0+BfJXYPhfl/obqmx7cyBFH3kfPjN75KKogBtY/z5SLo+Ghrkm7IsGYYOxMcQBAEh1HZlWX5oQ5IksQOCYG2J9scNgyVJKhaLhUKhK7gTfwCwSO4vAdko4gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e75d54d863f8e3009a5427c99d5039a8/a6329/WoLFlow.webp 185w,\n/static/e75d54d863f8e3009a5427c99d5039a8/c5f8a/WoLFlow.webp 370w,\n/static/e75d54d863f8e3009a5427c99d5039a8/aced9/WoLFlow.webp 720w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e75d54d863f8e3009a5427c99d5039a8/b63e1/WoLFlow.png 185w,\n/static/e75d54d863f8e3009a5427c99d5039a8/c9d3d/WoLFlow.png 370w,\n/static/e75d54d863f8e3009a5427c99d5039a8/eefce/WoLFlow.png 720w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e75d54d863f8e3009a5427c99d5039a8/eefce/WoLFlow.png\"\n            alt=\"wake on lan with automate\"\n            title=\"wake on lan with automate\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>In the \"Send Wake-on-LAN\" block choose either port 7 or 9 and input your MAC address.</p>\n<p>You can now boot your computer from as far as your wifi can reach.</p>\n<h1>Step 4: Windows 10 OpenSSH</h1>\n<p>I've gone through many sources on this one. But the one with the most concise information has to be <a href=\"https://winaero.com/blog/enable-openssh-server-windows-10/\" target=\"_blank\">this</a>.</p>\n<p>Once again to summarize:</p>\n<ul>\r\n    <li>Go to \"Settings\" -> \"Apps\" -> \"Apps & features\"</li>\r\n    <li>Once there, click on \"Optional features\" then \"Add a feature\"</li>\r\n    <li>From the list select \"OpenSSH Server\" and install it</li>\r\n    <li>Go to c:\\windows\\system32\\Openssh and type \"cmd\" into the explorer window.</li>\r\n    <li>Type ssh-keygen -A in the command prompt to generate the ssh key.</li>\r\n</ul>\n<p>Now, I have gone the more complicated route but apparently since then Microsoft has released a <a href=\"https://devblogs.microsoft.com/powershell/using-the-openssh-beta-in-windows-10-fall-creators-update-and-windows-server-1709/\" target=\"_blank\">tutorial</a>.</p>\n<ul>\r\n<li>Open PowerShell and type in:</li>\r\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">Install-Module</span> <span class=\"token operator\">-</span>Force OpenSSHUtils\r\n\r\n<span class=\"token function\">Repair-SshdHostKeyPermission</span> <span class=\"token operator\">-</span>FilePath C:\\Windows\\System32\\OpenSSH\\ssh_host_ed25519_key</code></pre></div>\n<p>Ok, you should now have a working SSH server.</p>\n<p>Try it out! You can open a connection from <a href=\"https://play.google.com/store/apps/details?id=com.termux&#x26;hl=en\" target=\"_blank\">Termux</a> for example. Open Termux and type in:</p>\n<div class=\"gatsby-highlight\" data-language=\"termux\"><pre class=\"language-termux\"><code class=\"language-termux\">ssh name@host.</code></pre></div>\n<p>Where \"name\" is your user name and \"host\" is your computers name(or IP address). Once you fill in the password\r\nyou will have access to the command prompt and from there you can control your computer remotely.</p>\n<h1>Step 5: ConnectBot SSH keys</h1>\r\nI suspect it is because we're trying to send a command from a unix environment to windows\r\nbut regardless, the command you give to ConnectBot will not pass an \"enter\" key and so won't execute automatically.\n<p>Luckily the SSH protocol has a solution. You can assign a command to individual keys and that's precisely what\r\nwe need to automate turning off the PC. Connect, execute a script and disconnect.</p>\n<p>In this case the script is a simple command: \"cmd /c shutdown /p\"</p>\n<p>In ConnectBot create your own public key and send it to your Windows PC.</p>\n<p>There go to \"Users/YOUR_NAME/.ssh and open authorized_keys for editing.</p>\n<p>Put in: <b>command=\"cmd /c shutdown /p\" CONNECTBOT_SSH_KEY</b></p>\n<p>Where CONNECTBOT_SSH_KEY is the key you've generated in ConnectBot.</p>\n<h1>Step 6: Automate ConnectBot</h1>\r\nHopefully the last step.<br>\r\nCreate the following flow:\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/56a2921f45af41e477e15109fe021786/eefce/TurnOffFlow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 211.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAqCAIAAAA8m+yHAAAACXBIWXMAAAsTAAALEwEAmpwYAAADnklEQVRIx9VUbW/bVBS+TdexTdoYaEIImDaJiTEmfgD/gU9o/4APIEHpCGuTrqIFCtVeWoQQSKAJITZRgcQ+pGsgbfPWNyfd2pRCWzUppEmcxfaNr+3Eju3E9jWKPao0UlpH4wuPjo/Oufa5z9U59zE45A2fHlk4fzN2uD/s8oR2rdPyHZ5QV3/4zMji+Rux175+cHEsfmE09sJnC898MtfpCYFOb+jEYPTUx3OuvhD4YAb0BsEV22bs4JA3dHJw9qmh2ScHZ58emn12eP74h9GjAxGXJwSOXI2cGIyC3uCpj+YujsVPjyycu06cu0G8MhZ78Trx/Kfz9omODkSODUQ6rKCrP3xsIHLkagS4eqYOe0LgncATfcGz14hXP4+fvbb40s3YhdH4y6Px54bnQXcAvBsA70/XrTsA3DPgvSmXe7qjZwp4/am+yVS/P9U7mbzs27pyL+me2Lrs2+rx1b17Iun1p7z+lMcy714PzMcA0A2sGVi3TGvwTtLHYzZNE2NsJ3bgPP0fM/+Xx9Z1XdM0XdcNC5oFwzAav2l5bIQQhJBlWZIkKYpiWRZCKEnSAcx2zFpACPl8PoIgJEmiaVoUxYOZMcY8z5MkuZVM3r+/tLq6ur29TdN0S+amYoRQoVDIZjN5MpfLZtLpNEVRu8z7Hds0TUEQOI4TBOGtX5hbBKvLAmSRLMuOGoYtmCb+dkmKppV6/w3cRNByVPXA8ks5NcPXrPU9W+/HLIqiJIrlcvmNceGLhbJZFflSuVqtOmoYhJCiKEks377763SUEMslpw3DGHMcR9M0Qmjy3kRiZZnjOIZpZ875fD6RSPyd3Nz8c21jY7O9GwYhzOzsfBdY8y+uM4U8zTCOmE3TVFVVUWRVVS+Nc18ulk2zKlZkTdOcStLeneS1kmK0J0lLjvXH/Zs4vloxTb1acyZJjHHRAlssdv+Q+Cmel0uIZhw3DCFULBYhZH6+8/3GWkIoldqQpF2cTqfX1zeWl1coioIQtrwkTcUsyzIQPsznSTKXy2ULhQLTMKoDJVniEBJ4/u278BZR1CQeFtm2JflVTAz+9UiSTVPE+0iyxfAfveXkWlU3DvhvG3iPkg0rubNSODkUvXT7D1Uz2vjp2xu9/s2Drr7w8d7g7zmujWKb2bf28Mxw+M0fl2u1GtBbw65pXsQ6XyqpqoKxAeR/UalURFHcTVVV3bGgKIrcgIr1SrYWWxYripLNZjOZTFNxI/4B5pPv99BCuQUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/56a2921f45af41e477e15109fe021786/a6329/TurnOffFlow.webp 185w,\n/static/56a2921f45af41e477e15109fe021786/c5f8a/TurnOffFlow.webp 370w,\n/static/56a2921f45af41e477e15109fe021786/aced9/TurnOffFlow.webp 720w\"\n              sizes=\"(max-width: 720px) 100vw, 720px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/56a2921f45af41e477e15109fe021786/b63e1/TurnOffFlow.png 185w,\n/static/56a2921f45af41e477e15109fe021786/c9d3d/TurnOffFlow.png 370w,\n/static/56a2921f45af41e477e15109fe021786/eefce/TurnOffFlow.png 720w\"\n            sizes=\"(max-width: 720px) 100vw, 720px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/56a2921f45af41e477e15109fe021786/eefce/TurnOffFlow.png\"\n            alt=\"SSH turn off with automate\"\n            title=\"SSH turn off with automate\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>In the \"Start shortcut\" block pick ConnectBot and choose the connection tied to the key that executes shutdown.</p>\n<p>Congrats, you have now turned your smartphone into a remote on and off button &#x26;#x1F642</p>\n<p>This doesn't even scratch the surface of what you can do with a running SSH connection however. Go wild, your imagination is the limit.</p>","frontmatter":{"date":null,"slug":"auto_pc","title":"Automate Windows 10 from your Android device","feature_image":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABs0lEQVQoz32RQUvcUBDHn1VppWp7bwX1oj2VfgZPXnpq8Vz8AoKKIhSkVW9CoXjfnmq0roZWo8sieBEPq+Bad0vrTWTb3TUvsbt5MTHvX+Ylj1J1OzDMzMt7v/xnhkkZgezUKcDcH8LgZgpsKUTzShXsk40HJsdMUaDd5GArHHcSp2+dJkfFj99HUqrINLBSP8Na7iUGviyAGRHYcgXMsNGc5nh97KGJIIYNtpT4oo2WNEf5JjBOROijdL6FyYM8Hn720GtxPN5w0J9x8e6Hj74tF10bDnosF72brorPshewL2Og5jBdRHEN6yfwKlfDaN7DyKGHqa8etssB5r4JvCkKzBaFyinOfxeoX8l/gToJFFFi4qgO9qEat/XxXM2KoBSpTdW2Eec0hltbJg8SiW+LQl2+v8bVA1oKKaNaL4Xm2nApWq4Gjuc9sFSi0LBxd5VjuiDQlvygNc3VMgjY8T/gVXKwUwkxnKvj+e5vPMm4eLTuKNUKQiMgX4xbvrfaAKhNH2oLIwknkPjlR1gvBXh/4mMs7+HFXg1Psy66LbexQr0cUkogeQ1+3QhwEf7tTG/5DzoeowHGpXbBAAAAAElFTkSuQmCC","aspectRatio":2,"src":"/static/55d84d4cd52d515422e6e2cd7dd227ef/72f41/AndroidWindowsLogo.png","srcSet":"/static/55d84d4cd52d515422e6e2cd7dd227ef/dc883/AndroidWindowsLogo.png 250w,\n/static/55d84d4cd52d515422e6e2cd7dd227ef/f9cf9/AndroidWindowsLogo.png 500w,\n/static/55d84d4cd52d515422e6e2cd7dd227ef/72f41/AndroidWindowsLogo.png 1000w,\n/static/55d84d4cd52d515422e6e2cd7dd227ef/13487/AndroidWindowsLogo.png 1500w,\n/static/55d84d4cd52d515422e6e2cd7dd227ef/15bf6/AndroidWindowsLogo.png 2000w,\n/static/55d84d4cd52d515422e6e2cd7dd227ef/adb50/AndroidWindowsLogo.png 3964w","sizes":"(max-width: 1000px) 100vw, 1000px"}}},"author":{"frontmatter":{"name":"Nick","profile_image":"/images/authors/author0.png","twitter":"","facebook":"","website":"https://nickrivulet.com"}},"tags":[{"frontmatter":{"name":"Projekty","slug":"projects"}},{"frontmatter":{"name":"Programování","slug":"coding"}}],"meta_description":"Automate a windows pc with android device using ssh, the automate app and the connectbot app","published_at":"09.08.2020","comment":false,"id":"auto_pc"},"excerpt":"In this guide you're going to learn how to turn on and control your PC from your Android smartphone (no root required).\r\nI will go over the…"}},"pageContext":{"slug":"auto_pc"}},
    "staticQueryHashes": ["2219164485"]}